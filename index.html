<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Pavimentação</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00a884">
<style>
/* ================= WHATSAPP STYLE UI ================= */
:root{
  --bg:#0b141a; --panel:#111b21; --card:#202c33; --text:#e9edef;
  --sub:#8696a0; --accent:#00a884; --border:#2a3942;
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#f0f2f5; --panel:#ffffff; --card:#ffffff; --text:#111b21;
    --sub:#667781; --accent:#25d366; --border:#e9edef;
  }
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);
font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial}
.app{max-width:900px;margin:auto;min-height:100vh;display:flex;flex-direction:column}
.topbar{background:var(--panel);padding:14px 16px;font-size:18px;font-weight:600;border-bottom:1px solid var(--border)}
.step{display:none}.step.active{display:block}
.content{padding:12px;flex:1}
.card{background:var(--card);border-radius:12px;padding:14px;margin-bottom:12px}
h2{font-size:14px;color:var(--sub);margin:0 0 8px;text-transform:uppercase}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px}
input{width:100%;padding:12px;font-size:16px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text)}
label{font-size:13px;color:var(--sub)}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{padding:8px 14px;border-radius:20px;border:1px solid var(--border);font-size:14px}
input:checked + .chip{background:var(--accent);color:#fff;border-color:var(--accent)}
input[type=checkbox],input[type=radio]{display:none}
.footer{position:sticky;bottom:0;background:var(--panel);padding:12px;border-top:1px solid var(--border)}
button{width:100%;padding:14px;font-size:16px;font-weight:600;border:none;border-radius:10px;background:var(--accent);color:#fff}
.bubble{background:var(--card);border-radius:14px;padding:12px;margin-bottom:8px}
.value{color:var(--accent);font-weight:600}
</style>
</head>
<body>
<div class="app">
  <div class="topbar">Pavimentação</div>

  <div class="content">

    <!-- STEP 1 -->
    <div class="step active" id="step1">
      <div class="card">
        <h2>1 · Método de cálculo</h2>
        <div class="chips">
          <label><input type="radio" name="metodo" value="total" checked><span class="chip">Pista inteira</span></label>
          <label><input type="radio" name="metodo" value="faixas"><span class="chip">Bordo / pista</span></label>
        </div>
      </div>
      <div class="card">
        <h2>Trecho</h2>
        <div class="grid">
          <div><label>Estaca inicial</label><input id="ini" placeholder="91 ou 91+5"></div>
          <div><label>Estaca final</label><input id="fim" placeholder="92 ou 92+10"></div>
          <div><label>Largura CBUQ (m)</label><input id="larg"></div>
        </div>
      </div>
    </div>

    <!-- STEP 2 -->
    <div class="step" id="step2">
      <div class="card">
        <h2>2 · Materiais</h2>
        <div class="chips">
          <label><input type="checkbox" id="cbuq" checked><span class="chip">CBUQ</span></label>
          <label><input type="checkbox" id="bref"><span class="chip">Bica Reforço</span></label>
          <label><input type="checkbox" id="bsub"><span class="chip">Bica Sub-base</span></label>
          <label><input type="checkbox" id="bgs"><span class="chip">BGS</span></label>
        </div>
      </div>
    </div>

    <!-- STEP 3 -->
    <div class="step" id="step3">
      <div class="card">
        <h2>3 · Processamento</h2>
        <div class="bubble">Comprimento, volumes e custos calculados automaticamente.</div>
      </div>
    </div>

    <!-- STEP 4 -->
    <div class="step" id="step4">
      <div class="card">
        <h2>4 · Resultado</h2>
        <div id="resultado"></div>
      </div>
    </div>

  </div>

  <div class="footer">
    <button onclick="nextStep()">Continuar</button>
  </div>
</div>

<script>
// ===== BASE DE DADOS =====
const materiaisDB={
  CBUQ:{esp:0.05,dens:2.53,delta:0,preco:263.04,tipo:'t'},
  BREF:{esp:0.30,dens:2.4,delta:1.92,preco:180.59,tipo:'v'},
  BSUB:{esp:0.20,dens:2.4,delta:1.12,preco:180.59,tipo:'v'},
  BGS:{esp:0.15,dens:2.4,delta:0.52,preco:241.97,tipo:'v'}
};
const lig={CAP:0.048,RR:0.0007,EAI:0.0012};
const ligPreco={CAP:5547.75,RR:4476.94,EAI:5716.46};

let step=1;
function nextStep(){
  document.getElementById('step'+step).classList.remove('active');
  step=Math.min(step+1,4);
  document.getElementById('step'+step).classList.add('active');
  if(step===4) calcular();
}

function estacaM(t){
  if(!t) return NaN;
  t=t.replace(',','.');
  if(!t.includes('+')) return Number(t)*20;
  const [e,f]=t.split('+');
  return Number(e)*20+Number(f);
}

function calcular(){
  const ci=estacaM(ini.value);
  const cf=estacaM(fim.value);
  const comp=cf-ci;
  const larg=Number(larg.value.replace(',','.'));

  let html='';

  if(cbuq.checked){
    const area=comp*larg;
    const vol=area*materiaisDB.CBUQ.esp;
    const ton=vol*materiaisDB.CBUQ.dens;
    const custo=ton*materiaisDB.CBUQ.preco;

    const cap=ton*lig.CAP;
    const rr=area*lig.RR;
    const eai=area*lig.EAI;

    const custoLig=cap*ligPreco.CAP+rr*ligPreco.RR+eai*ligPreco.EAI;

    html+=`<div class="bubble">CBUQ: <span class="value">${ton.toFixed(2)} t</span></div>`+
          `<div class="bubble">Custo CBUQ: <span class="value">R$ ${custo.toFixed(2)}</span></div>`+
          `<div class="bubble">Ligantes: <span class="value">R$ ${custoLig.toFixed(2)}</span></div>`;
  }

  resultado.innerHTML=html;
}
</script>
</body>
</html>